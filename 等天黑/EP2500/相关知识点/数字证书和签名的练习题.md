![[Pasted image 20260109003911.png]]

### 2 Asymmetric key management (2 非对称密钥管理)

Figure 1 Hierarchy List (图 1 层级列表)

- Root CA-1, Root CA-2 (根 CA-1, 根 CA-2)
- Level2 CA-1, Level2 CA-2... (二级 CA-1, 二级 CA-2...)
- Regional CA-1 to CA-5... (区域 CA-1 至 CA-5...)
- CA-1 to CA-8 (底层 CA-1 至 CA-8)

Original Text: Figure 1: Public Key Infrastructure (PKI) hierarchy. For Ex. 2, Ex. 3, and Ex. 4 below, please consider the PKI hierarchy in Fig. 1: each Certificate Authority (CA) CA-1, CA-2, ..., CA-8 interacts with users (A, B, C,...Z) and it is provided with a certificate from the CA at the hierarchical level above, e.g., CA-5 from Regional CA-3; which in turn gets its certificate from Level2 CA-2, etc. The two root CAs have self-generated certificates. Each user registers with at most one bottom-level CA and obtains a certificate.

中文翻译： 图 1：公钥基础设施 (PKI) 层级结构。 对于下面的练习 2、练习 3 和练习 4，请考虑图 1 中的 PKI 层级结构：每个证书颁发机构 (CA) CA-1, CA-2, ..., CA-8 与用户 (A, B, C,...Z) 交互，并且该 CA 持有由上一层级 CA 颁发的证书（例如：CA-5 的证书来自 Regional CA-3；而 Regional CA-3 的证书又来自 Level2 CA-2，以此类推）。两个根 CA 拥有自生成证书（即自签名证书）。每个用户最多在一个底层 CA 注册并获得证书。

---

### Exercise 2 Certificate issuance and use (练习 2：证书的颁发与使用)

Original Text: 4 Exercise 2 Certificate issuance and use (70 points) Consider A registered with CA-3 and U registered with CA-8. Each CA has its own registration authority that establishes registration info for A and CA-3 and registration info for U and CA-8 respectively.

中文翻译： 4 练习 2：证书的颁发与使用 (70 分) 考虑 A 在 CA-3 注册，U 在 CA-8 注册。每个 CA 都有自己的注册机构，分别建立 A 与 CA-3 的注册信息，以及 U 与 CA-8 的注册信息。

---

#### Question 1

Original Text:

1. (10 pt) Consider A with registration info requesting CA-3 a certificate. To ensure accountability, who generates A’s public/private key pair and why?

中文翻译：

1. (10 分) 考虑拥有注册信息的 A 向 CA-3 请求证书。为了确保问责性（accountability，即不可抵赖性），谁应该生成 A 的公钥/私钥对？为什么？

---

#### Question 2

Original Text: 2. (20 pt) What should the certificate signing request sent by A to CA-3 include? What are key elements/fields in the newly acquired certificate of A?

中文翻译： 2. (20 分) A 发送给 CA-3 的证书签名请求（CSR）应该包含什么内容？A 新获得的证书中的关键元素/字段是什么？

---

#### Question 3

Original Text: 3. (10 pt) Consider B, registered with CA-5, running a Transport Layer Security (TLS) handshake with A. Please describe what A needs to do to validate B’s certificate. (Please do not write the TLS protocol).

中文翻译： 3. (10 分) 考虑在 CA-5 注册的 B，正在与 A 进行传输层安全 (TLS) 握手。请描述 A 需要做什么来验证 B 的证书。（请不要描写 TLS 协议的具体细节）。

---

#### Question 4

Original Text: 4. (10 pt) Assume now C, also registered with CA-5, runs TLS with A. How can A, having interacted with B earlier, reduce computation overhead when validating C’s certificate?

中文翻译： 4. (10 分) 假设现在同样在 CA-5 注册的 C 与 A 运行 TLS。鉴于 A 早先与 B 交互过，A 如何减少验证 C 证书时的计算开销？

---

#### Question 5

Original Text: 5. (20 pt) Consider next U communicating with A. Can A validate U’s certificate? Please explain how and add needed steps (if any).

中文翻译： 5. (20 分) 接下来考虑 U 与 A 通信。A 能验证 U 的证书吗？请解释如何验证并补充所需的步骤（如果有）。

---

### Answer of exercise 2 (练习 2 的答案)

#### Answer 1

Original Text:

1. (10 pt) A generates its own key pair, create an certificate signing request encapsulating newly created public key, signing it with the corresponding private key, and sends it to CA-3 with registration info. If all is well, CA-3 signs the request with its private key, creating a certificate. The resulting certificate is sent back to A.

中文翻译：

1. (10 分) A 生成自己的密钥对，创建一个封装了新创建公钥的证书签名请求（CSR），用对应的私钥对其签名，并连同注册信息一起发送给 CA-3。如果一切正常，CA-3 用自己的私钥签署该请求，以此创建证书。生成的证书被发回给 A。

---

#### Answer 2

Original Text: 2. (20 pt) CSR should include the public key of A, signature generated by A’s private key, expiration date, serial number, name of the user (subject name). The certificate should include everything that CSR has, the name of the CA (issuer field) that signed the certificate, and signature generated by CA’s private key.

中文翻译： 2. (20 分) CSR 应该包含 A 的公钥、由 A 的私钥生成的签名、过期日期、序列号、用户名称（主体名称）。证书应包含 CSR 中的所有内容，签署该证书的 CA 名称（颁发者字段），以及由 CA 私钥生成的签名。

---

#### Answer 3

Original Text: 3. (10 pt) A will try to verify B’s certificate but it will see that it is signed by CA-5. A will check if it has the public key of CA-5. If it does not, it will go to issuer, CA-5, and get the certificate of CA-5 which includes its public key. However, A needs to verify the newly obtained certificate of CA-5. It will check if it has the public key of Regional CA-3. If it does not, it will again go to the issue and get the certificate. This process will continue until it reaches the root CA-1 which A trusts. If all the certificates are valid, A will be able to verify B’s certificate by tracing the chain.

中文翻译： 3. (10 分) A 将尝试验证 B 的证书，但会看到它是由 CA-5 签名的。A 会检查自己是否有 CA-5 的公钥。如果没有，它会去找颁发者 CA-5，获取包含其公钥的 CA-5 证书。但是，A 需要验证这个新获取的 CA-5 证书。于是它会检查自己是否有 Regional CA-3 的公钥。如果没有，它会再次去找这个颁发者获取证书。这个过程会一直持续，直到到达 A 所信任的 Root CA-1。如果所有证书都有效，A 就能通过追踪证书链来验证 B 的证书。

---

#### Answer 4

Original Text: 4. (10 pt) In the previous step, A has already verified the certificate of CA-5. Therefore, it does not need to verify it again. It can directly verify the certificate of C by the public key of the CA-5. This will happen if the certificate of CA-5 is not expired and A cached it previously.

中文翻译： 4. (10 分) 在上一步骤中，A 已经验证了 CA-5 的证书。因此，它不需要再次验证 CA-5。它可以使用 CA-5 的公钥直接验证 C 的证书。这需要在 CA-5 的证书未过期且 A 之前已对其进行了缓存的情况下才能实现。

---

#### Answer 5

Original Text: 5. (20 pt) With the current construction, A cannot validate U’s certificate since the parties have different root CAs. To make this work, root CAs need to cross certify each other. Simplest way to do this, A’s root CA signs the certificate of U’s root CA and vice versa, given that they trust each other. A can ask its own root CA about the root CA-2, whether it is trusted or not. If it is, root CA-1 can then return the certificate of root CA-2 to A, signed with its private key.

中文翻译： 5. (20 分) 在当前的架构下，A 无法验证 U 的证书，因为双方拥有不同的根 CA（信任锚点）。要使验证可行，根 CA 之间需要相互交叉认证。最简单的方法是，A 的根 CA 签署 U 的根 CA 的证书，反之亦然（假设它们相互信任）。A 可以询问自己的根 CA 关于 Root CA-2 是否可信。如果可信，Root CA-1 可以将用自己私钥签名的 Root CA-2 证书返回给 A。
