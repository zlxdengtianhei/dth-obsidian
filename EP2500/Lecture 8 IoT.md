基于您提供的关于物联网（IoT）安全的介绍文本（幻灯片1-8的内容），我为您整理并详细扩展了相关的知识体系。

这段文本的核心在于阐述物联网安全与传统网络安全的区别，重点在于**受限的资源**、**物理世界的交互（CPS）**以及由此产生的**特殊安全挑战**。

以下是基于原文内容的详细知识解读：

---

### 第一部分：物联网的网络基础与通信协议

原文首先界定了讨论的范围，即物联网不仅仅是简单的联网，它依赖于特定的网络系统和链路技术。

#### 1. 多样化的数据链路层技术

物联网设备并不单一依赖某一种连接方式，而是根据应用场景选择最合适的技术：

- **IEEE 802.11 (Wi-Fi) 及其变体：**
    - **基础模式 (Infrastructure Mode)：** 这是我们最熟悉的Wi-Fi模式，设备通过接入点（AP/路由器）连接。在IoT中，这通常用于有持续电源供电、需要较高带宽的设备（如监控摄像头）。
    - **Ad Hoc 模式与车载通信：** 原文特别提到联网车辆（Connected Vehicles）。车辆通信（V2X）通常依赖于 IEEE 802.11 的变体（如 802.11p 或 DSRC），它们往往需要支持 **Ad Hoc（自组网）** 通信。这意味着车辆之间可以直接通信，而不需要经过基站或路由器。这种去中心化的通信方式对安全提出了更高要求，因为没有中央权威机构实时验证每一个数据包。
- **低功耗技术 (Zigbee/802.15.4 & Bluetooth)：**
    - **Zigbee / IEEE 802.15.4：** 这是专为低速率、低功耗设计的协议。常用于智能家居（如灯泡、传感器）。它们的数据包很小，旨在延长电池寿命。
    - **蓝牙 (Bluetooth)：** 用于短距离通信。
    - **重点解读：** 这些技术与Wi-Fi的根本区别在于**资源预算**。它们不能承受复杂的握手协议或巨大的加密开销，因此传统的安全协议（如完整的TLS/SSL）往往需要经过裁剪或替换才能在这些协议上运行。

#### 2. 网络拓扑结构：多跳通信 (Multi-hop)

- 原文提到“一般拓扑结构”和“多跳通信”。在许多IoT网络（特别是无线传感器网络 WSN）中，设备A可能无法直接联系到网关，它必须将数据传给设备B，B再传给C，最终到达目的地。
- **安全隐患：** 如果中间节点（设备B）被攻破，它不仅能窃听数据，还能篡改数据或丢弃数据（黑洞攻击），从而切断部分网络的连接。

---

### 第二部分：物联网平台的本质属性——受限环境

这是理解IoT安全的核心前提。原文花费了大量篇幅描述IoT设备的物理限制。

#### 1. 资源受限平台 (Resource-limited Platforms)

- **计算能力极低：** 许多IoT节点是微控制器（MCU），只有几KB的内存和很慢的CPU。
    - _知识扩展：_ 这意味着它们无法运行复杂的加密算法（如长密钥的RSA）。安全设计必须使用**轻量级密码学 (Lightweight Cryptography)**。
- **能源受限 (Energy Constraints)：** 许多设备由电池供电，甚至依靠能量采集（太阳能、振动）。
    - _知识扩展：_ 发送无线电信号是非常耗电的。如果安全协议要求频繁的握手或过长的数据包头，会迅速耗尽电池，导致设备“死亡”。这被称为**拒绝睡眠攻击 (Denial of Sleep)** 的潜在目标。
- **受限的无线电收发器：** 低功耗意味着传输距离短、比特率（带宽）低。安全数据包必须非常紧凑。

#### 2. 两大类典型系统

- **无线传感器网络 (WSNs)：**
    - 通常是静态的（节点位置固定）。
    - 主要任务是环境监测。
    - _关于路由发现的说明：_ 原文明确指出**不在此处重新讨论“安全路由发现”**。这是因为路由发现通常在移动自组网（MANETs）的背景下讨论，那里节点是移动的，挑战更大。对于静态的WSN，路径建立相对稳定，因此原文假设“安全路径建立”已经解决。
- **车载通信系统 (VCS / Connected Vehicles)：**
    - 这是IoT的一个特殊分支，节点（车辆）是高速移动的，且能量限制相对较小（车辆有大电池），但对**实时性**要求极高。

---

### 第三部分：网络物理系统 (Cyber-Physical Systems, CPS)

原文强调了IoT与传统互联网的根本区别：**与物理世界的互联**。

#### 1. 什么是网络物理系统？

- IoT不仅仅是传输数据，它是一个反馈循环：**感知 (Sensory Inputs) -> 计算/通信 -> 行动 (Actuation)**。
- **场景举例：**
    - **森林监测：** 嵌入森林的节点监测火灾风险。
    - **智慧城市：** 路灯上的传感器监测噪音或污染。
    - **智能建筑：** 收集数据以自动调节温度、光照、通风。
    - **联网车辆：** 根据传感器数据自动刹车或调整方向。

#### 2. 物理暴露与无人值守

- **物理保护有限：** 与锁在服务器机房里的服务器不同，IoT设备通常安装在路边、野外或公共场所。
- **无人值守 (Unattended)：** 它们在没有人类实时监控的情况下运行。
- **安全后果：** 攻击者可以轻易地物理接触设备，将其拆开，读取内存，甚至替换硬件。这使得**物理层面的防御**变得至关重要。

#### 3. 规模与复杂性

- **网络之网络 (Network of Networks)：** IoT不是单一网络，而是各种嵌入式网络与移动网络、互联网的互联。
- **海量设备：** 部署数量巨大，导致管理困难（例如，如何给一百万个灯泡打补丁？）。

---

### 第四部分：具体的安全挑战 (Specific Challenges)

基于上述背景，原文列出了六大核心挑战，这是IoT安全研究的重点：

#### 1. 安全与资源的平衡 (Security vs. Resources)

- **挑战：** 如何在不耗尽设备资源（CPU、内存、电池）的前提下部署安全措施？
- **详解：** 传统的安全机制（如频繁的证书验证）对于IoT设备来说过于“沉重”。如果安全机制导致电池在一个月内耗尽（原本设计为一年），那么这个安全机制就是失败的。

#### 2. 功能性需求与实时性 (Functional Requirements)

- **挑战：** 强安全性不能阻碍系统的核心功能。
- **详解：** 在车载系统中，如果为了验证消息的签名需要花费500毫秒，而车辆需要在100毫秒内做出刹车反应，那么这种安全性是不可接受的。**实时性 (Real-time)** 往往优于复杂的安全性。

#### 3. 密钥泄露与侧信道攻击 (Key Compromise & Side-channel Attacks)

- **挑战：** 密钥更容易被窃取。
- **详解：**
    - **物理攻破：** 攻击者把设备偷走，通过JTAG接口读取内存中的密钥。
    - **侧信道攻击 (Side-channel Attacks)：** 原文特别提到这一点。由于设备计算能力弱且物理暴露，攻击者可以通过分析设备的**功耗变化**、**电磁辐射**或**处理时间**来推导出加密密钥，而无需破解算法本身。

#### 4. 针对新应用类型的攻击

- **挑战：** 新的功能带来新的攻击面。
- **详解：** 以前没有“远程关闭引擎”或“远程解锁大门”的功能，现在有了，攻击者就会针对这些功能开发特定的漏洞利用代码。

#### 5. 适应无线与CPS特性的安全协议

- **挑战：** 需要设计新的协议来应对物理特性。
- **详解：** 原文举例了 **邻居发现 (Neighbor Discovery)**。在有线网络中，你清楚地知道谁插在网线上。但在无线网络中，攻击者可以伪装成你的“邻居”（女巫攻击/Sybil Attack），或者通过放大信号假装自己在附近（虫洞攻击/Wormhole Attack）。安全协议必须能验证物理位置和身份的真实性。

#### 6. 被利用作为僵尸网络 (Exploitation as Bots - DDoS)

- **挑战：** IoT设备反过来攻击互联网。
- **详解：** 这是原文提到的最后一点，也是连接到更广泛安全话题的一点。由于IoT设备数量巨大（数以亿计）且防护较弱（通常使用默认密码），攻击者可以轻易感染它们，组成庞大的**僵尸网络 (Botnet)**。
- **后果：** 攻击者利用这些设备向目标服务器发起**分布式拒绝服务 (DDoS)** 攻击。虽然单个摄像头的攻击力很弱，但一百万个摄像头同时发起请求，足以通过流量淹没任何大型网站。

---

### 总结

这段文本构建了一个关于IoT安全的完整逻辑链：  
**技术基础**（Wi-Fi/Zigbee/多跳）+ **平台限制**（低功耗/低算力）+ **物理环境**（无人值守/CPS） -> 导致了 -> **独特的安全挑战**（资源权衡/物理攻击/DDoS跳板）。

---
这份资料主要探讨了物联网（IoT）环境下的安全威胁模型，特别是针对无线传感器网络（WSN）和车联网通信系统（VCS）的攻击方式。

以下是基于原文内容的详细知识梳理：

---

### 1. 物联网中的故障与物理威胁 (Failures & Physical Threats)

在讨论复杂的网络攻击之前，原文首先指出了物联网设备面临的基础性挑战。

- **良性故障 (Benign Failures)：**
    - **定义：** 指非恶意攻击导致的设备失效。
    - **常见类型：** 电池耗尽（Battery depletion）、设备损坏（Breakdown）、无线电干扰（Radio interference）以及无线电传播障碍（Radio propagation obstacles）。
    - **原因：** 物联网设备通常处于“无人值守”（unattended）的状态，且使用的是低功耗无线收发器，抗干扰和抗恶劣环境能力较弱。
- **物理破坏 (Physical Destruction)：**
    - 由于设备无人值守，攻击者更容易接近物理设备并对其进行蓄意破坏。

---

### 2. 输入控制型对手 (Input Controlling Adversary) —— **重点概念**

这是一个针对传感系统特有的攻击模型，原文对此进行了详细定义。

- **核心概念：** 这种攻击者并不直接入侵传感器的计算核心或通信模块（即不破解加密、不修改代码），而是通过改变物理环境来误导传感器。
- **攻击手段：**
    - 例如：通过外部加热来升高温度传感器的读数。
    - 例如：屏蔽信号，阻止传感器接收相关信号。
- **后果：** 传感器节点会诚实地报告它“感知”到的数据，但这些数据是错误的（由攻击者控制的）。这会导致系统基于错误数据触发错误的操作（如发出虚假警报、改变网络物理系统的运行状态）。
- **性质：** 这本质上是一种**外部攻击**（External Adversary），因为它不需要加入网络，却能导致错误数据的传播和收集。

---

### 3. 对手模型与 Dolev-Yao 模型 (Adversary Models) —— **重点概念**

原文引用了经典的密码学攻击模型，并将其扩展到物联网场景。

- **通用假设 (General Assumption)：**
    - **强大的对手：** 假设攻击者非常强大，可以拦截、伪造、修改任何传输的消息。
    - **限制条件：** 攻击者**无法**破解涉及实体的私钥或密钥（Secret/Private Keys）。只要没有密钥，加密内容本身是安全的。
- **Dolev-Yao 模型在 IoT 中的应用：**
    - 攻击者具备拦截（Intercept）、伪造（Forge）、修改（Modify）消息的能力。
    - 攻击者可以有选择地中继（Relay）、重放（Replay）、丢弃（Drop）或擦除/干扰（Erase/Jam）消息。
- **密钥泄露途径：** 虽然假设加密算法本身不可破，但原文列举了密钥可能泄露的现实途径：
    - 弱密码（易猜测）。
    - 服务器被攻破导致密码泄露。
    - 社会工程学攻击。
    - 向攻击者签发了欺诈性证书。
    - 针对密钥建立协议的密码分析攻击。
    - 侧信道攻击（Side-channel attacks）。
    - **WSN 特有：** 从被物理捕获的设备中提取对称密钥。

---

### 4. 外部攻击者与重放/虫洞攻击 (External Adversary & Wormhole) —— **重点概念**

外部攻击者指没有网络合法身份（密钥）的攻击者。

- **窃听 (Eavesdropping)：**
    - 攻击者可能拥有与网络设备相同的通信范围，或者拥有更强的大功率设备（覆盖更大范围）。
    - **最坏情况：** 全局窃听者（Global eavesdropper），能监控整个网络的流量。
- **主动攻击 (Active Attacks)：**
    - 注入消息，试图冒充合法节点。
    - **记录与重放 (Record and Replay)：** 记录网络数据包，并在一段时间后重新播放，以扰乱系统运行（例如重放旧的测量数据）。
- **虫洞攻击 (Wormhole Attack) / 隧道攻击：**
    - **机制：** 至少需要两个攻击节点（或者一个节点进行物理层中继）。一个节点在一个位置记录流量，通过一条私密的、低延迟的通道（“隧道”）传给另一个位置的同伙，由同伙重放这些数据。
    - **特点：** 这种攻击甚至可以在物理层进行，不需要解析数据包。
    - **后果：** 这种链路看起来质量极高（跳数少、延迟低），因此会吸引大量网络流量经过这个“虫洞”。攻击者借此完全控制了流经的路径，可用于后续的流量分析或丢包攻击。

---

### 5. 内部攻击者 (Internal Adversary) —— **重点概念**

内部攻击者指已经被攻破或本身就是恶意的合法网络节点（拥有合法密钥）。

- **能力：** 拥有外部攻击者的所有能力，且更具破坏性。
- **攻击行为：**
    - **伪造与修改：** 可以解密并修改消息，或者生成合法的伪造消息。
    - **拒绝服务 (DoS) - 堵塞攻击 (Clogging)：** 内部节点可以发起大规模流量注入。相比外部攻击者（容易被防火墙或认证机制在边缘拦截），内部攻击者的非法流量更难被识别，能深入网络内部造成严重拥堵。
    - **路由攻击：** 影响路由发现过程（Route Discovery）。

---

### 6. 无线传感器网络 (WSN) 的路由与聚合攻击 (Routing & Aggregation Attacks)

原文详细描述了 WSN 的数据收集架构及其特有的弱点。

- **WSN 路由架构：**
    - **汇聚节点 (Sink)：** 数据收集的终点。
    - **树状拓扑 (Tree Topology)：** 网络通常形成一棵以 Sink 为根的树。
    - **建立方式：** 为了效率，通常不是每个节点单独发起路由发现，而是由 Sink 广播控制流量，节点转发并标记自己的“父节点”（Parent）。
- **网内聚合 (In-network Aggregation) 及其漏洞：**
    - **机制：** 为了节省能源，子节点将数据发给父节点，父节点不直接转发所有原始数据，而是将自己和子节点的数据进行计算（如求平均值、最大值、最小值），只发送一个**聚合结果**给上一级。
    - **优势：** 极大减少传输次数，提高效率。
    - **漏洞：** 如果负责聚合的父节点是**恶意的（内部攻击者）**，它可以完全忽略子节点的真实数据，向 Sink 发送任意伪造的聚合值。这种攻击很难被下游节点检测到，因为原始数据在聚合点被“消化”了。

---

### 7. 车联网通信系统 (VCS) 攻击 (Attacks against VCS) —— **重点概念**

原文最后一部分（幻灯片 20 起）转向了车联网安全，强调了安全与隐私的双重挑战。

- **针对安全性的攻击：**
    - **虚假安全警告：** 攻击者注入虚假的交通安全警告（如“前方事故”），导致驾驶员或自动驾驶系统做出不必要的刹车或变道，反而可能引发事故。
    - **虚假交通状态：** 注入虚假拥堵信息，破坏交通效率。
- **恶意且理性的攻击 (Malicious yet Rational)：**
    - **场景：** 攻击者改装车载单元（OBU），冒充特种车辆（如救护车）。
    - **目的：** 发送“救护车接近”的消息，迫使其他车辆减速让路。
    - **理性动机：** 攻击者并非为了破坏系统，而是为了私利（在拥堵中快速通行）。
- **隐私挑战 (Privacy)：**
    - **数据痕迹：** VCS 消息包含详细的时间、位置信息，且发送频率极高。这些信息留下了关于车辆及其驾驶员/乘客的丰富轨迹。
    - **风险：** 如果没有适当的对策，这些本应私密或获取成本极高的信息变得唾手可得。
    - **难点：** 许多 VCS 消息（特别是为了交通安全的消息）**不要求保密性**（Confidentiality），即必须明文广播以便周围车辆迅速处理，这使得隐私保护变得更加困难。

---

### 总结

这段文本从基础的物理故障讲起，深入到了 IoT 特有的攻击模型（如输入控制攻击），并详细对比了内部与外部攻击者在 WSN 环境下的不同表现（如虫洞攻击、聚合攻击）。最后，它探讨了车联网场景下，攻击如何从单纯的破坏演变为理性的自利行为，以及由此引发的严峻隐私问题。

---
### 3. 物联网安全概览 (Securing IoT)

原文首先设定了讨论的背景。在物联网环境中，安全机制不仅仅是关于加密数据，还涉及到设备如何发现彼此、如何建立信任以及如何防止物理层面的攻击（如干扰）。

- **讨论范围**：
    - **蓝牙 (Bluetooth)**：侧重于用户输入参与的相互认证和安全通信。
    - **Zigbee**：侧重于无线传感器网络（WSN）中的通用网络设置。
    - **安全邻居发现 (Secure Neighbor Discovery)**：这是一个关键概念，原文提到它与安全路由有关，并强调了无线通信的物理维度（如信号强度、距离等）如何引入新的安全属性和机制。
    - **VCS安全**：基于新兴标准的车辆通信系统（Vehicular Communication Systems）安全（原文仅提及作为结尾，未展开细节）。

---

### 3.1 蓝牙安全机制 (Bluetooth Security)

这是原文中最核心、篇幅最长的部分。它详细描述了蓝牙设备如何从零开始建立信任关系。

#### 1. 基础概念与角色

- **抗干扰性**：原文回顾了模块2中的内容，指出蓝牙使用**跳频扩频 (Frequency Hopping)** 技术来作为一种抗干扰（Jamming Resilience）的方法。这不仅提高了通信的稳定性，也增加了一定的物理层安全性。
- **设备角色**：在建立连接时，蓝牙设备被分为两个角色：
    - **主设备 (Master)**：发起连接或控制连接的一方。
    - **从设备 (Slave)**：响应连接的一方。
- **唯一标识符**：每个蓝牙设备都有一个全球唯一的地址，称为 **BDADDR (Bluetooth Device Address)**。这个地址在后续的密钥生成算法中起着至关重要的作用。

#### 2. 配对与初始密钥 (Pairing & Kinit)

蓝牙安全的核心在于“配对”（Pairing），即两个从未见过的设备如何建立信任。

- **共享秘密 (Shared Secret)**：
    - 配对的基础是 **PIN (Personal Identification Number)** 码。
    - 通常是4位十进制数字，但标准允许最长达128位。
    - **用户交互**：用户需要在两个设备上输入相同的PIN码。如果其中一个设备没有输入接口（例如蓝牙耳机），它通常有一个固定的PIN码（如0000），用户需要在另一个有接口的设备（如手机）上输入该码。
- **生成初始密钥 ($K_{init}$)**：
    - **算法**：使用 **E22** 算法（基于 **SAFER+** 加密算法）。
    - **输入**：
        1. PIN码（长度为 $L$）。
        2. 由一个设备生成的随机数（Nonce）。
        3. BDADDR（蓝牙设备地址）。
    - **输出**：生成初始对称密钥 **$K_{init}$**。

#### 3. 链路密钥生成 (Link Key Generation)

$K_{init}$ 只是临时的，用于安全地交换信息以生成更持久、更强大的**链路密钥 ($K_{link}$)**。

- **交换随机数**：
    - 设备A生成128位的随机数 $RAND_A$。
    - 设备B生成128位的随机数 $RAND_B$。
    - 这两个随机数在传输前会与 $K_{init}$ 进行 **异或 (XOR)** 运算，以防止被窃听。
- **计算过程**：
    - **算法**：使用 **E21** 算法（同样基于 SAFER+）。
    - **输入**：每个设备将自己的 BDADDR 和 RAND，以及对方的 BDADDR 和 RAND 输入算法。
    - **输出**：算法产生两个中间值 $LK_A$ 和 $LK_B$。
    - **最终合成**：将 $LK_A$ 和 $LK_B$ 进行异或运算，得到最终的链路密钥 **$K_{link}$**。

#### 4. 相互认证 (Mutual Authentication)

一旦拥有了 $K_{link}$，设备就不再需要 PIN 码或 $K_{init}$ 了。接下来的认证过程基于挑战-响应（Challenge-Response）机制。

- **角色**：
    - **验证者 (Verifier)**：发送挑战的一方。
    - **响应者 (Responder)**：证明自己身份的一方。
- **认证步骤**：
    1. 验证者发送一个随机挑战值 **$AU_{RAND}$** 给响应者。
    2. **计算响应 (SRES)**：
        - **算法**：使用 **E1** 算法（基于 SAFER+）。
        - **输入**：$AU_{RAND}$、响应者的 BDADDR、以及共享的链路密钥 $K_{link}$。
        - **输出**：生成 32 位的签名响应 **SRES (Signed Response)**。
    3. 响应者将计算出的 SRES 发送回验证者。
    4. 验证者在本地使用相同的输入运行 E1 算法，并将结果与收到的 SRES 进行比对。如果一致，认证成功。
- **双向认证**：上述过程只证明了响应者的身份。为了实现相互认证，双方交换角色（验证者变为响应者，反之亦然）并重复上述过程。

#### 5. 加密密钥生成与保密性 (Encryption Key & Confidentiality)

认证成功后，为了防止后续通信被窃听，需要对链路进行加密。

- **ACO (Authenticated Ciphering Offset)**：在上述认证过程中，E1 算法除了生成 SRES，还会计算出一个名为 ACO 的值。
- **生成加密密钥 ($K_{enc}$)**：
    - **算法**：使用 **E3** 算法。
    - **输入**：链路密钥 $K_{link}$ 和 ACO。
    - **输出**：加密密钥 **$K_{enc}$**。
- **用途**：$K_{enc}$ 用于后续数据传输的加密，确保链路的保密性。

> **重点总结**：蓝牙安全依赖于一系列基于 SAFER+ 的算法（E22, E21, E1, E3），通过 PIN 码引导出 $K_{init}$，进而生成 $K_{link}$ 用于认证，最后衍生出 $K_{enc}$ 用于加密。

---

### 3.2 Zigbee 安全机制 (Zigbee Security)

原文对 Zigbee 的介绍相对简略，主要强调了其标准定义和核心加密技术。

- **定义**：Zigbee 标准定义了 **无线个人局域网 (WPANs)** 的数据链路层。它常用于低功耗、低数据速率的控制和监控应用（如智能家居）。
- **核心安全技术**：
    - **对称密钥 (Symmetric Keys)**：Zigbee 安全完全依赖于对称密钥体系，即发送方和接收方使用相同的密钥。
    - **AES (Advanced Encryption Standard)**：用于实现认证（Authentication）和保密性（Confidentiality）。AES 是目前公认的非常强大的加密标准（通常使用128位密钥）。
- **限制说明**：原文提到由于时间限制，讨论非常简短，没有深入到具体的密钥交换协议或帧结构。

---

### 原文提及的额外概念与省略说明

1. **安全邻居发现 (Secure Neighbor Discovery)**：
    
    - 原文提到这是一个重点，特别是在无线传感器网络（WSN）和路由的背景下。
    - **核心思想**：利用无线通信的物理特性（Physical Dimensions，如信号传播时间、接收信号强度等）来验证邻居是否真实存在于声称的位置，防止“虫洞攻击”或“女巫攻击”。
    - _注：原文仅提及了概念和物理维度的重要性，未详细展开具体协议。_

---
这份回答涵盖了原文中提到的所有核心概念，未做任何实质性省略。我将按照逻辑顺序，从背景、基础架构、核心挑战、解决方案（随机密钥预分配）到具体协议流程进行深度解析。

---

### 1. 物联网与 WSN 安全的演变与现状

**原文背景：**  
随着时间的推移，物联网（IoT）设备发生了显著进化。即使是小型设备（Small-footprint platforms），其计算能力也变得越来越强。

**核心原则：对称密钥加密的主导地位**  
尽管计算能力提升，但在 WSN 和 IoT 安全领域，**对称密钥加密（Symmetric Key Cryptography）** 依然占据主导地位。

- **详细解读：**
    - **原因：** 尽管公钥加密（Public Key Cryptography，如 RSA 或 ECC）安全性高，但其计算复杂度和能耗对于电池供电、资源受限的传感器节点来说仍然过于昂贵。对称加密（如 AES）在加解密速度和能耗上具有巨大优势。
    - **用途：** 主要用于数据的**加密/解密**（保密性）以及**认证/完整性校验**（确保数据未被篡改且来源可靠）。
    - **历史一致性：** 这种做法与无线安全的其他领域是一脉相承的。例如 Wi-Fi 安全、IPsec IKEv2 和 TLS 握手。在这些协议中，公钥加密通常仅用于初始阶段的身份认证和密钥协商（Key Establishment），一旦建立了会话，后续的数据传输都依赖于成对（Pairwise）或组（Group）对称密钥。
    - **结论：** WSN 节点极少使用公钥加密，绝大多数时间依赖对称密钥。

---

### 2. 基础安全架构：节点与汇聚节点（Sink）的关系

**基本配置：**  
WSN 安全的第一步是预配置（Pre-configure）。每个传感器节点 $V_i$ 在部署前，都会预置一个与汇聚节点（Sink, $S$）共享的成对密钥：$K_{S,V_i}$。

**密钥的作用与衍生：**

- **直接使用：** $K_{S,V_i}$ 可以直接用于加密和认证。
- **密钥衍生：** 为了更高的安全性，通常会将加密和认证功能分离。可以通过 $K_{S,V_i}$ 计算出两个独立的密钥：一个专门用于加密/解密，另一个专门用于认证。

**端到端安全（End-to-End Security）：**

- **机制：** 节点采集的数据（如温度、湿度测量值）使用 $K_{S,V_i}$ 进行加密和认证，然后发送给 Sink。
- **对抗内部攻击者：** 原文特别指出了这种机制的优势（参考幻灯片 41 的红色节点）。即使攻击者入侵了网络中的某个中间节点（路由路径上的节点），或者攻击者本身就在传输路径上，由于数据是用端到端密钥 $K_{S,V_i}$ 加密的，中间节点无法解密数据。这保证了**测量的保密性（Confidentiality of measurements）**。

---

### 3. 核心挑战：节点与节点之间的安全通信

虽然节点与 Sink 之间有了安全保障，但 WSN 是多跳网络，节点之间需要相互通信（例如路由转发）。这就引出了一个关键问题：**如何建立节点到节点（Node-to-Node）的安全连接？**

**方案 A：利用 Sink 作为密钥分发中心（KDC）**

- **思路：** 既然所有节点都和 Sink 有共享密钥，那么如果节点 A 想和节点 B 通信，可以通过 Sink 转发来协商一个新密钥。
- **缺陷（原文重点）：**
    1. **效率低下：** 每次建立连接都要经过 Sink，通信开销大。
    2. **部署初期的“鸡生蛋”问题：** 在网络部署初期，节点可能还没有找到通往 Sink 的路由路径。如果没有路由，就无法联系 KDC，也就无法获得与邻居通信的密钥，从而无法建立路由。这是一个死锁。

**方案 B：随机密钥预分配（Random Key Pre-distribution）**  
这是原文着重介绍的解决方案，旨在解决上述 KDC 方案的缺陷。

---

### 4. 重点解析：随机密钥预分配方案 (Random Key Pre-distribution)

这是一个简单而巧妙的想法，用于在没有任何先验知识（不知道节点会被部署在哪里，也不知道谁会是邻居）的情况下建立信任。

#### 4.1 核心机制

1. **密钥池（Key Pool）：** 生成一个非常大的密钥池（包含成千上万个密钥）。
2. **密钥环（Key Ring）：** 每个传感器节点在出厂前，从这个大密钥池中**随机**抽取一组密钥（例如 100 个），存入自己的存储器中。这组密钥被称为“密钥环”。
3. **部署：** 节点被随机撒布到区域内。

#### 4.2 概率连通性原理

- **问题：** 两个随机相遇的邻居节点 $V_1$ 和 $V_2$，它们的密钥环 $ring_1$ 和 $ring_2$ 里会有相同的密钥吗？
    - **如果有（交集非空）：** 它们可以使用这个公共密钥建立安全连接。
    - **如果没有（交集为空）：** 它们在部署初期无法直接进行安全通信。
- **设计目标：** 我们不需要保证任意两个节点都能通信，只需要保证**足够高**的概率。
- **参数选择：**
    - **密钥池大小：** 需要足够大，以支持大规模网络，并保证每个节点的密钥环具有独特性（安全性）。
    - **密钥环大小：** 需要足够大，以增加两个环出现交集的概率（直觉上，环越大，撞车的概率越高）；但又不能太大，受限于节点的存储空间，且不能让一个节点掌握全网大部分密钥（否则该节点被俘获后网络风险剧增）。
- **概率示例：** 原文举例，如果任意两个邻居共享至少一个密钥的概率是 90%，且一个节点有 $k$ 个物理邻居，那么它大约能与 $0.9k$ 个邻居建立安全关联。这通常足以构建一个连通的网络图。

---

### 5. 重点解析：密钥发现协议 (Key Discovery Protocol)

即使两个节点拥有公共密钥，它们如果不告诉对方，也是无法使用的。因此需要一个协议来“发现”这个公共密钥。原文详细描述了这个**成对协议（Pairwise Protocol）**的流程。

#### 5.1 协议流程详解

假设节点 $V_2$ 发起，节点 $V_1$ 响应。

**第一步：发起 (Initial Message)**

- $V_2$ 发送广播或单播消息：$(V_2, \text{InitKeyDiscovery}, \text{nonce}_2)$
- **目的：** 宣告 $V_2$ 想要寻找共享密钥，并提供一个随机数 $\text{nonce}_2$ 用于防止重放攻击。

**第二步：响应与证据提供 (Response)**

- $V_1$ 收到消息后，检查自己的密钥环 $ring_1$。
- 对于 $ring_1$ 中的每一个密钥 $K_{1j}$，$V_1$ 向 $V_2$ 发送如下消息：  
    $V_1 \rightarrow V_2 : \text{nonce}_2, V_2, V_1, \text{nonce}_1, \text{ShortKeyID}_j, \text{auth}_{K_{1j}}(\dots)$
- **消息组件解析：**
    - $\text{nonce}_2$：证明这是对 $V_2$ 请求的回应。
    - $V_2, V_1$：标识通信双方 ID。
    - $\text{nonce}_1$：$V_1$ 生成的随机数，用于后续交互的新鲜性。
    - $\text{ShortKeyID}_j$（可选）：密钥 ID 的简短版本（例如密钥哈希的截断值），用于帮助 $V_2$ 快速索引，避免暴力试错。
    - $\text{auth}_{K_{1j}}(\dots)$：这是核心。使用候选密钥 $K_{1j}$ 对消息内容（包括随机数和 ID）计算的消息认证码（如 HMAC）。

**第三步：验证与确认 (Verification)**

- $V_2$ 收到消息后，根据 $\text{ShortKeyID}_j$ 在自己的密钥环 $ring_2$ 中查找对应的密钥。
    - 如果找不到 ID，说明没有这个密钥。
    - 如果没提供 ID，$V_2$ 可能需要尝试 $ring_2$ 中的所有密钥。
- $V_2$ 使用找到的密钥重新计算 HMAC。如果计算结果与收到的 $\text{auth}()$ 一致，则**发现成功**。
- **结论：** $V_2$ 确认 $V_1$ 确实拥有该密钥。

#### 5.2 发现后的状态

- 发现过程可能会找到不止一个共享密钥。
- 一旦发现成功，双方就可以使用该共享密钥（或基于共享密钥衍生的会话密钥）来实现**逐跳（Hop-by-Hop）**的认证、完整性保护和机密性。

---

### 6. 总结：多层安全防御体系

原文最后强调了 WSN 安全的整体架构，它是由两层互补的安全机制构成的：

1. **端到端安全 (Node-to-Sink)：**
    
    - **密钥：** $K_{S,V_i}$
    - **作用：** 保护传感器采集的数据（Measurements）。
    - **优势：** 即使传输路径上的中间节点被攻陷（恶意节点），攻击者也无法解密原始数据。
2. **逐跳安全 (Neighbor-to-Neighbor)：**
    
    - **密钥：** 通过随机密钥预分配和密钥发现协议找到的公共密钥。
    - **作用：** 保护链路层的通信，防止外部攻击者注入虚假路由信息或篡改数据包头，确保下一跳节点的合法性。

**综上所述，** 这部分内容展示了 WSN 如何在资源受限和无预先拓扑信息的条件下，通过**对称加密**、**预置主密钥**和**随机密钥预分配**相结合的方式，构建起一个既能保护数据隐私又能抵抗网络攻击的健壮系统。


---
接续上一部分的回答，我们继续深入探讨 WSN 安全中的进阶话题。

在上一部分中，我们建立了基于对称密钥 $K_{S,V_i}$ 的端到端安全和基于随机预分配密钥的逐跳安全体系。然而，安全是一个动态的攻防过程。接下来的内容主要探讨当最坏的情况发生——即**密钥泄露（Key Compromise）**时，如何通过**中途重加密（En-route Re-encryption）**和**密钥更新（Key Refreshing）**来挽救数据的机密性。

以下是对原文的详细解读和知识梳理：

---

### 1. 核心威胁：密钥泄露 (Key Compromise)

这是本节讨论的出发点。虽然我们预置了密钥 $K_{S,V_i}$，但它并非绝对安全。

**泄露途径：**

- **物理接触：** 传感器节点通常部署在无人值守的区域，攻击者可以物理捕获节点并读取内存。
- **侧信道攻击（Side-channel attack）：** 即使不物理拆解，攻击者也可以通过分析节点的功耗、电磁辐射等特征来推导出密钥。

**泄露的后果（重点）：**

- **一般情况：** 一旦攻击者掌握了 $K_{S,V_i}$，理论上他就能解密该节点发送的所有测量数据。
- **位置的影响：**
    - **靠近源节点：** 如果攻击者仅仅是在源节点附近，但没有下一跳邻居的共享密钥，那么上一节提到的“逐跳安全（Hop-by-hop security）”可能会阻止攻击者接入网络。
    - **位于通信路径上（On-path Adversary）：** 这是最危险的情况。如果攻击者已经渗透到了从源节点 $V_i$ 到 Sink 的路由路径中（例如攻陷了一个路由器节点），或者攻击者能够拦截路径上的流量。此时，无论中间经过了多少次逐跳的链路层加密，只要攻击者拥有端到端的解密密钥 $K_{S,V_i}$，他就可以剥离链路层保护，直接解密出原始测量数据。

**提出的问题：**  
如果 $K_{S,V_i}$ 已经被泄露了，我们还有办法保护测量数据不被窃取吗？

---

### 2. 解决方案一：中途重加密 (En-route Re-encryption)

原文给出的第一个肯定回答是使用“中途重加密”。这是一个非常直观且强大的防御机制。

#### 2.1 基本原理

当数据从源节点 $V_i$ 传输到 Sink 的过程中，途经的每一个（或部分）转发节点 $V_j$，都利用自己与 Sink 共享的密钥 $K_{S,V_j}$ 对数据包进行**再次加密**。

这就像“洋葱”一样，数据每经过一跳，就被包裹上一层新的加密外壳。

#### 2.2 协议流程详解（重点）

假设路径为：$V_1 \rightarrow V_2 \rightarrow V_3 \rightarrow V_4 \rightarrow S$（Sink）。

1. **源节点 $V_1$ 发送：**
    
    - $V_1$ 生成测量数据 $m$。
    - 计算 HMAC 用于端到端认证：$h = \text{HMAC}(m, \text{nonce}, V_1, S)$。
    - 使用 $K_{S,V_1}$ 加密：$\hat{m}_1 = E_{K_{S,V_1}}(m, \text{nonce}, h, V_1, S)$。
    - 发送消息：$(\hat{m}_1, \text{nonce}, V_1)$。
2. **中间节点 $V_2$ 重加密：**
    
    - $V_2$ 收到 $\hat{m}_1$。注意，$V_2$ 不需要（也无法）解密 $\hat{m}_1$。
    - $V_2$ 使用**自己的密钥** $K_{S,V_2}$ 对 $\hat{m}_1$ 进行再加密。
    - 生成 $\hat{m}_2 = E_{K_{S,V_2}}(\hat{m}_1)$。
    - $V_2$ 将自己的身份 $V_2$ 附加在后面，发送给 $V_3$。
3. **后续节点 ($V_3, V_4$) 重复操作：**
    
    - $V_3$ 将 $\hat{m}_2$ 加密为 $\hat{m}_3$（使用 $K_{S,V_3}$），附加 $V_3$。
    - $V_4$ 将 $\hat{m}_3$ 加密为 $\hat{m}_4$（使用 $K_{S,V_4}$），附加 $V_4$。
    - 最终发送给 Sink 的消息结构类似于：$(E_{K_{S,V_4}}(E_{K_{S,V_3}}(E_{K_{S,V_2}}(\hat{m}_1))), V_4)$。
4. **Sink 节点的解密过程（剥洋葱）：**
    
    - Sink 收到消息，首先看到明文 ID $V_4$。
    - Sink 查找 $K_{S,V_4}$，解密最外层，得到 $\hat{m}_3$ 和 ID $V_3$。
    - Sink 查找 $K_{S,V_3}$，解密下一层，得到 $\hat{m}_2$ 和 ID $V_2$。
    - ...以此类推，直到解密出 $\hat{m}_1$，最后使用 $K_{S,V_1}$ 解密得到原始数据 $m$ 和 HMAC。
    - **验证：** Sink 检查 nonce 的新鲜性（防止重放），并验证 HMAC（确保数据完整性和源认证）。

#### 2.3 安全性分析

- 即使攻击者拥有源节点的密钥 $K_{S,V_1}$，他也无法解密在线路上截获的数据包，因为数据包被外层的 $K_{S,V_2}, K_{S,V_3}$ 等密钥包裹着。
- 除非攻击者同时攻陷了路径上**所有**参与重加密的节点，否则数据就是安全的。

---

### 3. 优化方案：概率性重加密 (GossiCrypt)

**问题：**  
完全的逐跳重加密带来了显著的开销：

1. **通信开销：** 每次重加密都可能增加数据包大小（例如填充），且必须附加节点 ID，导致数据包越来越大。
2. **计算开销：** 每个节点都要进行加密操作，消耗能量。

**解决方案：GossiCrypt 算法**  
原文提到了 _GossiCrypt_ 这一方案，核心思想是引入**概率 $q$**。

- **机制：** 路径上的节点不是“必须”重加密，而是以概率 $q$ ($q < 1$) 决定是否对数据进行重加密。
- **权衡 (Trade-off)：**
    - $q$ 值越高：安全性越高（攻击者需要攻陷更多节点才能解密），但开销越大。
    - $q$ 值越低：效率越高，但安全性下降。
- **防御效果：**
    - 如果攻击者只掌握了 $K_{S,V_1}$，那么路径上只要有**一次**重加密发生，攻击者就无法解密。
    - 如果攻击者是有针对性的，逐步攻陷路径上的节点，那么就需要更多的重加密层级来抵御。

---

### 4. 进阶防御：密钥更新 (Key Refreshing)

如果网络面临严重的、针对性的入侵（Targeted Compromise），仅仅依靠重加密可能不够（因为攻击者可能会顺藤摸瓜攻陷路径上的节点）。此时，需要从源头解决问题：**更换被泄露的密钥**。

原文引用了 GossiCrypt 的 Section IV-B 部分，详细介绍了这一机制。

#### 4.1 密钥更新流程

1. **生成新密钥：** 传感器节点 $V_i$ 本地生成一个新的密钥。
2. **公钥加密（关键点）：** 节点使用 Sink 的**公钥 ($Pub_S$)** 对新密钥进行加密。
    - _注意：_ 虽然前文提到 WSN 尽量避免公钥加密，但在这里，为了安全地传输新密钥，必须使用非对称加密。因为旧的对称密钥 $K_{S,V_i}$ 可能已泄露，不能用来加密新密钥。
3. **伪装传输：**
    - 节点将“加密后的新密钥”作为普通的“测量数据（Payload）”进行封装。
    - 使用当前的（可能已泄露的）旧密钥计算 HMAC。
    - 将这个数据包发送出去，并利用上述的**概率性中途重加密**机制进行传输。
4. **Sink 处理：** Sink 收到数据后，使用私钥解密出新密钥，并更新数据库。

#### 4.2 为什么有效？

- **针对仅泄露密钥的情况：** 如果攻击者只是通过侧信道攻击或密码分析破解了旧密钥 $K_{S,V_i}$，但并没有完全控制节点 $V_i$ 的硬件（即没有控制节点的 CPU 和内存），那么密钥更新非常有效。
    - 攻击者截获了更新包，但他没有 Sink 的私钥，无法解密出新密钥。
    - 攻击者拥有旧密钥，但他解密后只能看到一堆乱码（即被公钥加密的新密钥）。
- **针对完全控制的情况：** 如果攻击者完全控制了节点 $V_i$（Physical Capture），那么密钥更新是无效的，因为攻击者可以直接在节点内存中读取新生成的密钥。

#### 4.3 隐蔽性 (Stealth)

原文特别指出了这种设计的一个精妙之处：**隐藏刷新事件**。

- 通过将加密的新密钥伪装成普通的数据负载（Payload），攻击者无法从流量特征上分辨出这是一个“密钥更新包”还是一个“普通数据包”。
- 攻击者只有在尝试用旧密钥解密后续数据失败时，才会意识到密钥已经被更新了。

#### 4.4 代价与收益

- **代价：** 调用公钥加密算法计算成本高，消耗更多电量。
- **收益：** 更新频率越高，攻击者手中掌握的有效密钥就越少。这是一个计算成本与安全性的博弈。

---

### 总结

这部分内容构建了一个纵深的防御体系，用于应对 WSN 中最棘手的密钥泄露问题：

1. **第一道防线：** 基础的端到端加密（$K_{S,V_i}$）。
2. **第二道防线（应对 $K_{S,V_i}$ 泄露）：** **中途重加密**。利用中间节点的密钥层层包裹数据，使得拥有源节点密钥的攻击者无法解密拦截到的数据。
3. **优化策略：** **概率性重加密**。在安全性和能耗之间寻找平衡。
4. **终极手段（应对持续泄露）：** **密钥更新**。利用 Sink 的公钥安全地分发新密钥，并将其伪装成普通流量，从而在攻击者未察觉的情况下切断其访问权限。

---
基于您提供的关于 **VCS 安全与隐私（slides 64–73）** 的文本，我为您整理并详细解读了其中的核心知识体系。

这段内容主要探讨了车联网（VCS）在保障车辆通信安全的同时，如何通过复杂的公钥基础设施（PKI）设计来保护用户的隐私。

以下是基于原文的详细知识点介绍：

---

### 1. 车联网（VCS）的基础架构与特性

**定义与融合：**

- **VCS (Vehicular Communication Systems)** 是一项新兴技术。
- 它融合了多种技术领域：移动自组织网络（MANET）、基于基础设施的无线网络、传感技术以及大规模的网络物理交互（Cyber-physical interactions）。

**高风险特性：**

- **安全的重要性：** VCS 的安全性与其他网络一样重要，但其特殊性在于“高风险（High Stakes）”。
- **人身安全：** 因为人（驾驶员和乘客）身处车辆之中或周围，一旦发生网络攻击，直接威胁的是人的生命安全和福祉。
- **双重目标：** 既要保障**安全性（Safety/Security）**，又要保障**隐私（Privacy）**。必须确保车联网通信（VC）不会恶化用户的隐私状况。

**通信模式：**

1. **通信对象：** 车辆与车辆之间（V2V），以及车辆与路侧单元（Road-Side Units, RSUs）之间（V2I）。
2. **信标（Beacons）：**
    - **机制：** 车辆以每秒 $\gamma$ 次的频率广播信标。
    - **内容：** 包含车辆位置和时间戳。
    - **目的：** 让周围车辆感知彼此的位置和运动状态，这是交通安全的基础。
3. **路侧单元（RSUs）：**
    - **功能：** 广播通知信息。
    - **网关作用：** 作为接入点连接有线网络部分，例如允许车辆连接到其域内的证书颁发机构（CA）。
4. **其他通信：** 包括基于事件的通信，以及与有线网络上的服务进行的通信。

---

### 2. 安全与隐私的具体需求

原文引用了《Securing Vehicular Communications》中的分析，列出了以下关键需求：

**基本安全属性：**

- **认证（Authentication）：** 必须能验证消息发送者的合法性。
- **完整性（Integrity）：** 必须确保消息在传输过程中未被篡改。
- **新鲜度（Freshness）与时效性（Recency）：**
    - 原文特别在注脚中区分了这两个概念。不仅要确保消息不是重放的旧消息（Freshness），还要确保消息从应用角度看没有“太老”（Recency）。例如，关于位置或道路危险的更新，如果过了几秒钟可能就毫无意义甚至产生误导。
- **问责制（Accountability）与不可否认性（Non-repudiation）：** 必须能够事后追溯是谁发送了消息，发送者不能抵赖。

**核心矛盾与解决方案：条件匿名性（Conditional Anonymity）**  
这是VCS隐私保护的核心概念。

- **需求冲突：** 一方面需要保护隐私（匿名），另一方面在发生事故或违法时需要追责（实名）。
- **定义：**
    - **默认匿名：** 通信在设计上应该是匿名的。
    - **按需连接：** 在特定情况下（如事故调查），授权机构有能力揭示身份。
    - **长期不可关联（Unlinkable）：** 在中长期内，观察者无法将不同的通信片段关联到同一辆车。
    - **短期可关联（Linkable）：** 出于实际通信需要，短时间内的通信是可以被关联的。

---

### 3. 核心解决方案：假名（Pseudonyms）与公钥加密

为了实现上述“条件匿名性”，VCS 采用了基于公钥加密（Public Key Cryptography）的策略。

#### A. 两种证书体系

1. **长期证书（Long-Term Certificate）：**
    
    - **颁发者：** 长期证书颁发机构（LTCA）。
    - **内容：** 包含车辆的真实身份。
    - **作用：** 证明车辆在域内的合法注册身份。车辆拥有对应的长期公私钥对。
    - **隐私风险：** 如果直接使用此证书通信，车辆的所有轨迹将被轻易追踪。
2. **假名证书（Pseudonyms）：**
    
    - **颁发者：** 假名证书颁发机构（PCA）。
    - **内容：** **不包含**车辆的真实身份，是匿名化的证书。
    - **作用：** 仅证明该公钥是合法的。车辆使用假名对应的私钥进行签名。

#### B. 假名认证的工作流程（Slide 69）

- **发送方（车辆）：** 使用与假名证书中公钥对应的**私钥**对信标进行数字签名，并附上该假名证书。
- **接收方：** 即使之前从未遇到过该车辆，也可以通过附带的假名证书验证签名的合法性。

#### C. 通过“更换假名”实现隐私保护（重点）

这是实现**长期不可关联性**的关键机制。

- **策略：** 每个假名只使用很短的一段时间（分钟、小时或天，而不是像HTTPS证书那样用几年）。
- **链接性分析：**
    - 使用 $PNYM1_V$（车辆V的第1个假名）签名的消息之间是**容易关联**的（短期可关联）。
    - 但是，当车辆切换到 $PNYM2_V$ 时，观察者无法知道 $PNYM1_V$ 和 $PNYM2_V$ 属于同一辆车（长期不可关联）。
- **观察者视角：**
    - 假设有车辆 V 和车辆 U。
    - 观察者会看到一系列消息分别来自 $PNYM1_V, PNYM2_V, ...$ 和 $PNYM1_U, PNYM2_U, ...$。
    - 在观察者眼中，这看起来不像是两辆车，而像是**许多个不同的、短命的匿名发送者**。
- **结果：** 这种混淆机制有效地保护了车辆的长期轨迹隐私。

---

### 4. 车辆公钥基础设施（VPKI）的交互逻辑

车辆如何安全且匿名地获取这些假名？原文描述了一个类似于 Kerberos 但基于非对称密钥的流程。

**交互流程：**

1. **身份验证（与 LTCA）：**
    - 车辆首先向 LTCA 证明自己的身份（使用长期证书）。
    - LTCA 验证通过后，并不直接发假名，而是提供一个**令牌（Token）**。
2. **获取假名（与 PCA）：**
    - 车辆拿着这个令牌去请求 PCA。
    - PCA 验证令牌的有效性，然后颁发假名证书。
    - **关键点：** PCA 看到令牌，知道该请求是合法的，但 PCA **不需要知道**（也不应该知道）车辆的真实身份。
3. **结果：** 实现了**职权分离**。LTCA 知道“你是谁”但不知道“你用了什么假名”；PCA 知道“你的假名”但不知道“你是谁”。只有两者合谋（或在特定法律程序下）才能去匿名化。

**跨域扩展（Cross-Domain）：**

- VCS 系统支持多域架构。
- 车辆在“归属域（Home Domain）”注册。
- 当车辆行驶到“外地域（Foreign Domain）”时，可以利用类似的机制向外地的域请求假名，从而支持漫游时的安全通信。

---

### 总结

这段内容的核心逻辑在于：  
**车联网安全不仅是防止黑客入侵，更是保护物理世界的人身安全。** 为了在保障安全（需要认证）的同时保护隐私（防止追踪），系统引入了**VPKI**。通过将**身份认证（LTCA）**与**通信凭证（PCA/假名）**分离，并频繁更换**短期假名**，系统成功制造了“许多陌生人短暂出现”的假象，从而在满足可追溯性的法律要求下，最大限度地切断了长期追踪的可能性。